{"ast":null,"code":"import { Text } from 'react-native-paper';\nimport { useCallback, useEffect, useState, useRef } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { CheckboxMe } from \"./CheckBox\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nfunction ChapitreSelection(_ref) {\n  var pk = _ref.pk,\n    bible = _ref.bible,\n    livre = _ref.livre,\n    chapitre = _ref.chapitre,\n    setChapitre = _ref.setChapitre;\n  console.log('renderchapitreSelection');\n  var firstRender = useRef(true);\n  if (livre === 'null' || bible == 'null') {\n    return _jsx(Text, {\n      children: \"Can't display\"\n    });\n  }\n  var chapters = pk.gqlQuerySync(\"{\\n        docSet(id: \\\"\" + bible + \"\\\") {\\n          document(bookCode: \\\"\" + livre + \"\\\") {\\n            cvIndexes {\\n              chapter\\n            }\\n          }\\n        }\\n      }\");\n  var initialState = Array(chapters.data.docSet.document.cvIndexes.length).fill(false).map(function () {\n    return useState(false);\n  });\n  var renderItem = useCallback(function (_ref2) {\n    var item = _ref2.item;\n    return item;\n  }, []);\n  var keyExtractor = useCallback(function (item, index) {\n    return \"chap-\" + index;\n  }, []);\n  useEffect(function () {\n    if (firstRender.current) {\n      console.log(initialState);\n      firstRender.current = false;\n      console.log('ici');\n    } else {\n      console.log('la');\n      var newAC = new Array(0);\n      for (var i = 0; i < initialState.length; i++) {\n        if (initialState[i][0]) {\n          newAC.push(\"\" + i);\n        }\n      }\n      setChapitre(newAC);\n      firstRender.current = true;\n    }\n  }, [initialState]);\n  if (chapters.data.docSet.document != null) {\n    var data = [];\n    chapters.data.docSet.document.cvIndexes.map(function (doc, id) {\n      data.push(_jsx(CheckboxMe, {\n        num: doc.chapter,\n        checked: initialState[id][0],\n        setChecked: initialState[id][1]\n      }));\n    });\n    return _jsx(FlatList, {\n      data: data,\n      numColumns: 3,\n      keyExtractor: keyExtractor,\n      renderItem: renderItem\n    });\n  } else {\n    return _jsx(Text, {\n      children: \"Can't display\"\n    });\n  }\n}\nexport { ChapitreSelection };","map":{"version":3,"names":["Text","useCallback","useEffect","useState","useRef","View","FlatList","CheckboxMe","jsx","_jsx","ChapitreSelection","_ref","pk","bible","livre","chapitre","setChapitre","console","log","firstRender","children","chapters","gqlQuerySync","initialState","Array","data","docSet","document","cvIndexes","length","fill","map","renderItem","_ref2","item","keyExtractor","index","current","newAC","i","push","doc","id","num","chapter","checked","setChecked","numColumns"],"sources":["/home/gabriel/repos/jxt-korennumi/components/proofOfConcept/ChapitreSelection.js"],"sourcesContent":["import { Text } from 'react-native-paper';\nimport { useCallback, useEffect, useState,useRef } from 'react';\n\nimport { View, FlatList } from 'react-native';\nimport { CheckboxMe } from './CheckBox';\n\nfunction ChapitreSelection({ pk, bible, livre, chapitre, setChapitre }) {\n  console.log('renderchapitreSelection')\n  let firstRender = useRef(true);\n\n  if (livre === 'null' || bible == 'null') {\n    return <Text>{`Can't display`}</Text>\n  }\n  let chapters = pk.gqlQuerySync(\n    `{\n        docSet(id: \"${bible}\") {\n          document(bookCode: \"${livre}\") {\n            cvIndexes {\n              chapter\n            }\n          }\n        }\n      }`);\n\n\n\n  const initialState = Array(chapters.data.docSet.document.cvIndexes.length).fill(false).map(() => useState(false));\n\n  const renderItem = useCallback(({ item }) => item, []);\n  const keyExtractor = useCallback((item, index) => `chap-${index}`, []);\n  useEffect(() => {\n    if (firstRender.current) {\n      console.log(initialState)\n      firstRender.current = false\n      console.log('ici')\n    }\n    else {\n      console.log('la')\n      let newAC = new Array(0)\n      for (let i = 0; i < initialState.length; i++) {\n        if (initialState[i][0]) {\n          newAC.push(`${i}`)\n        }\n      }\n      setChapitre(newAC)\n      firstRender.current = true\n    }\n  }, [initialState]);\n\n\n  if (chapters.data.docSet.document != null) {\n    let data = []\n    chapters.data.docSet.document.cvIndexes.map((doc, id) => {\n      data.push(\n        <CheckboxMe num={doc.chapter} checked={initialState[id][0]} setChecked={initialState[id][1]}></CheckboxMe>\n      )\n    })\n    return <FlatList\n      data={data}\n      numColumns={3}\n      keyExtractor={keyExtractor}\n      renderItem={renderItem} />\n  } else {\n    return <Text>{`Can't display`}</Text>\n  }\n}\nexport { ChapitreSelection }\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}